---
tags:
  - MILAB
  - ComputerVision
  - Backbones
  - PoseEstimation
  - SemanticSegmentation
---

# HRNet: Deep High-Resolution Representation Learning

## 1. 요약 (Abstract)

> **HRNet(High-Resolution Network)** 은 공간적으로 민감한(spatially sensitive) 비전 작업, 특히 [[Pose Estimation]]을 위해 제안된 새로운 CNN 백본 아키텍처입니다. 기존의 네트워크들이 저해상도(low-resolution) 표현으로 정보를 압축한 뒤 다시 고해상도로 복원하는 방식을 사용한 것과 달리, HRNet은 **네트워크 전체에 걸쳐 고해상도 표현을 계속 유지**하면서, 서로 다른 해상도의 피쳐들을 반복적으로 융합(fusion)하여 **공간적 정밀도와 의미론적 풍부함(semantically rich)을 모두 갖춘 피쳐맵**을 생성합니다.

---

## 2. 배경: 기존 방식의 한계 (Low-Resolution 병목)

[[Semantic Segmentation]]이나 [[Pose Estimation]]과 같은 조밀한 예측(dense prediction) 작업들은 **정확한 공간 정보**가 매우 중요합니다. 하지만 기존의 대표적인 네트워크들은 다음과 같은 한계를 가집니다.

- **직렬 연결된 Encoder-Decoder 구조**:
    - 대부분의 네트워크(e.g., [[U-Net|U-Net]], [[Hourglass]])는 고해상도 입력(high)을 받아 점차적으로 저해상도(low)로 압축하여(Encoder) 고차원의 의미 정보를 추출하고, 이를 다시 고해상도로 복원(Decoder)하는 방식을 사용합니다. (High → Low → High)
- **정보 손실 문제**: 이 과정에서 초기 고해상도 피쳐맵의 정밀한 공간 정보가 다운샘플링 과정 중에 상당 부분 **손실**될 수밖에 없습니다. Skip Connection 등으로 이를 일부 보완하지만, 근본적인 정보 손실을 피하기는 어렵습니다.

> **질문**: "왜 굳이 해상도를 줄였다가 다시 키워야 하는가? 처음부터 끝까지 고해상도를 유지할 수는 없을까?"

---

## 3. 핵심 아이디어: 고해상도 표현의 유지

HRNet은 위 질문에 대한 해답으로, 다음과 같은 혁신적인 아키텍처를 제안합니다.

1.  **병렬 다중 해상도 서브넷 (Parallel Multi-Resolution Subnetworks)**
    - 고해상도 서브넷에서 시작하여, 점차적으로 저해상도 서브넷을 **병렬적**으로 추가합니다. 즉, 네트워크가 깊어질수록 고해상도부터 저해상도까지 여러 개의 스트림(stream)이 동시에 존재합니다.
2.  **반복적인 다중 스케일 융합 (Repeated Multi-Scale Fusion)**
    - 네트워크의 여러 단계에 걸쳐, 병렬적으로 존재하는 모든 해상도의 서브넷들 간에 **정보를 반복적으로 교환하고 융합**합니다. 이를 통해 고해상도 피쳐는 정밀한 공간 정보를, 저해상도 피쳐는 풍부한 컨텍스트(context) 정보를 서로 공유하게 됩니다.

> 이 구조 덕분에 HRNet이 최종적으로 생성하는 고해상도 피쳐맵은, 해상도를 줄였다가 복원하는 과정 없이도 **처음부터 끝까지 정밀한 공간 정보와 깊은 의미 정보를 모두 포함**하게 됩니다.

---

## 4. HRNet 아키텍처 상세

HRNet은 크게 4개의 스테이지(Stage)로 구성되며, 각 스테이지는 병렬적인 컨볼루션 스트림들을 가집니다.

- **Stage 1**: 표준적인 CNN과 같이, 해상도를 줄여나가며 고차원 피쳐를 추출합니다.
- **Stage 2, 3, 4**: 
    - 기존의 고해상도 스트림은 그대로 유지됩니다.
    - 동시에, 해상도가 절반으로 줄어든 새로운 스트림이 병렬적으로 추가됩니다. (예: Stage 3에서는 고, 중, 저 3개의 스트림이 병렬로 존재)
    - 각 스테이지의 끝에는 **다중 스케일 융합 유닛(multi-scale fusion unit)** 이 존재합니다.

### 4.1. 다중 스케일 융합 (Multi-Scale Fusion)

이것이 HRNet의 가장 핵심적인 부분입니다. 융합 유닛은 모든 해상도의 스트림들로부터 다른 모든 스트림으로 정보를 전달합니다.

- **고해상도 → 저해상도**: 3x3 stride=2 컨볼루션을 사용하여 다운샘플링하며 정보를 전달합니다.
- **저해상도 → 고해상도**: 1x1 컨볼루션 + Upsampling(e.g., Nearest Neighbor)을 통해 업샘플링하며 정보를 전달합니다.

이러한 양방향 정보 교환이 네트워크 전체에 걸쳐 반복적으로 일어나면서, 각 해상도의 피쳐맵이 서로의 장점을 흡수하며 풍부해집니다.

---

## 5. 주요 응용 분야 및 성능

HRNet은 특정 작업에 종속되지 않는 강력한 **백본(Backbone) 네트워크**로, 다양한 분야에서 SOTA(State-of-the-Art) 성능을 달성했습니다.

- **인체 자세 추정**: 제안된 주 목적으로, COCO 데이터셋에서 Top-down 방식의 SOTA를 달성했습니다. 최종 고해상도 피쳐맵으로부터 직접 관절 위치를 나타내는 히트맵(heatmap)을 예측하여 매우 정밀한 결과를 얻습니다.
- **Semantic Segmentation**: Cityscapes, PASCAL-Context 등 주요 세그멘테이션 벤치마크에서도 뛰어난 성능을 보였습니다.
- **객체 탐지**: COCO 데이터셋을 사용한 객체 탐지에서도 기존 백본 네트워크들보다 우수한 성능을 입증했습니다.

---

## 6. 공헌 및 의의

- **새로운 아키텍처 패러다임 제시**: 기존의 직렬적인 Encoder-Decoder나 Hourglass 구조에서 벗어나, **병렬 다중 해상도 구조와 반복적 융합**이라는 새로운 패러다임을 제시했습니다.
- **고품질 표현 학습**: 공간적으로 정밀하면서도 의미적으로 풍부한 고품질 피쳐 표현을 학습하는 방법을 보여주었습니다.
- **범용성**: 특정 작업뿐만 아니라 다양한 컴퓨터 비전 분야에 효과적으로 적용될 수 있는 강력한 범용 백본으로서의 가능성을 입증했습니다.

---

## 7. 관련 노트

- **주요 응용 분야**: [[Pose Estimation]], [[Semantic Segmentation]]
- **비교 대상 아키텍처**: [[U-Net]], [[Hourglass|Hourglass]]
- **관련 기술**: [[Dilated Convolution|Dilated Convolution]]


**Felzenszwalb & Huttenlocher’s graph-based segmentation** (2004)은 **이미지를 그래프 형태로 표현하여 픽셀 또는 작은 영역을 빠르고 효율적으로 세그먼트(분할)** 하는 알고리즘입니다. **Selective Search**에서 초기 과분할(슈퍼픽셀 생성) 단계로 널리 사용됩니다.

---

## ✅ **핵심 아이디어**

1. 이미지를 **그래프 $G = (V, E)$** 로 모델링
    
    - **노드(V):** 이미지의 각 픽셀
        
    - **엣지(E):** 인접 픽셀 간의 연결
        
    - **엣지 가중치:** 픽셀 간 색상/밝기 차이(일반적으로 RGB 혹은 CIE Lab 거리)
        
2. **픽셀 간의 유사도 기반 병합**
    
    - 비슷한 픽셀끼리 같은 영역에 속하도록 병합.
        
    - **"영역 내부의 일관성"** 과 **"영역 간의 차이"** 를 비교하여 병합 여부 결정.
        
3. **효율적인 계층적 병합**
    
    - 작은 영역부터 시작해서 점점 병합 → 슈퍼픽셀 생성.
        

---

## ✅ **구체적인 연산 과정**

### 1. **초기화**

- 각 픽셀을 하나의 독립된 컴포넌트(영역)으로 시작.  
    즉, 처음에는 영역의 개수가 픽셀 수와 동일.
    

### 2. **엣지 정렬**

- 모든 엣지를 **가중치(색상/밝기 차이)** 기준으로 **오름차순 정렬**.  
    → 비슷한 픽셀부터 먼저 병합되도록 함.
    

### 3. **영역 병합 조건 계산**

영역 A와 B를 병합할지 여부는 다음 조건으로 결정됩니다:

#### (1) 내부 차이(Intra-region difference)

$$\text{Int}(C) = \max_{e \in MST(C)} w(e)$$

- $C$: 현재 영역
    
- $w(e)$: 영역 내부 엣지의 가중치
    
- $MST(C)$: 영역 C의 최소 신장 트리(Minimum Spanning Tree)  
    → **영역 내에서 가장 큰 엣지 가중치(즉, 영역 내부의 최대 차이)**
    

#### (2) 임계값(Threshold)

$$\tau(C) = k / |C|$$

- $k$: 사용자가 설정하는 상수 (보통 300~500)
    
- $|C|$: 영역의 크기(픽셀 수)  
    → 큰 영역일수록 병합이 더 어렵게(작은 ττ) 설정됨.
    

#### (3) 병합 조건

$$w(A,B) \le \min(\text{Int}(A) + \tau(A),\ \text{Int}(B) + \tau(B))$$

- $w(A,B)$: 영역 A와 B를 연결하는 엣지 가중치
    
- 즉, **두 영역 간의 경계 차이가 영역 내부의 일관성 + 허용 오차보다 작으면 병합**.
    

### 4. **반복**

- 엣지 가중치가 작은 것부터 순차적으로 병합 조건을 검사 → 병합
    
- 모든 엣지를 확인할 때까지 반복
    

### 5. **후처리 (옵션)**

- 너무 작은 영역(예: 50픽셀 이하)을 인접한 큰 영역과 병합.
    

---

## ✅ **결과**

- 영역의 수와 크기는 **파라미터 $k$**와 **최소 영역 크기**에 따라 결정.
    
- 보통 **수백~수천 개의 작은 슈퍼픽셀**이 생성 → **Selective Search**의 초기 과분할로 적합.
    

---

## ✅ **장단점**

✔ **장점**

- 매우 빠르고 효율적 (거의 선형 시간, O(n log n))
    
- 객체의 경계를 비교적 잘 보존
    
- 파라미터 $k$로 영역 크기를 조절 가능
    

✘ **단점**

- 완전히 고정된 영역 수를 지정할 수 없음
    
- 파라미터 $k$ 튜닝에 따라 결과가 크게 달라짐
    

---

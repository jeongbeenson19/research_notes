
## 📌 RANSAC이란?

**RANSAC**은 "RANdom SAmple Consensus"의 약자로,  
노이즈와 이상치(outlier)가 존재하는 데이터셋에서 **올바른 모델을 확률적으로 추정**하는 알고리즘입니다.

> 🔎 쉽게 말해,  
> 전체 데이터를 다 신뢰하지 말고,  
> 일부 "좋은 샘플"만 골라서 반복적으로 모델을 만들고  
> 그 중 가장 많은 데이터와 잘 맞는 모델을 선택하는 방식입니다.

---

## 🧠 RANSAC의 핵심 아이디어

1. **데이터 중 일부만 랜덤하게 선택**해서 모델을 추정한다.
    
2. 그 모델이 **전체 데이터 중 얼마나 많은 점들과 잘 맞는지 평가**한다.
    
3. 이 과정을 여러 번 반복해 **가장 잘 맞는 모델**을 선택한다.
    

---

## ⚙️ 알고리즘 절차

### 예: 직선 피팅(line fitting)을 예시로

1. **입력**:
    
    - 데이터셋 $D$
        
    - 모델 예: 직선 $y = ax + b$
        
    - 거리 허용치 $t$: 점이 모델에 잘 맞는다고 간주할 최대 거리
        
    - 최소 샘플 수 $n$: 직선을 정의하려면 점 2개 필요
        
    - 반복 횟수 $k$
        
2. **반복** ($k$번):
    
    1. 데이터셋 $D$에서 **무작위로 $n$개의 점** 선택
        
    2. 이 점들로 **모델 $M$** 추정
        
    3. 전체 데이터에 대해, $M$과의 거리가 $t$ 이하인 점들 → **내부점(inliers)** 으로 간주
        
    4. 내부점 개수가 지금까지 중 가장 크면 → 해당 모델 저장
        
3. **최종 모델**:
    
    - 가장 많은 내부점(inliers)을 가진 모델을 최종 선택
        

---

## 📊 시각적 이해

- 아래와 같은 경우를 생각해보세요:
    

```
o o o o o o    <- inliers (선상에 있는 점)
        x x x <- outliers (노이즈 점들)
```

- 보통 선형 회귀는 전체 평균을 고려하기 때문에 outlier의 영향을 크게 받습니다.
    
- RANSAC은 inlier만으로 모델을 반복적으로 추정하기 때문에, **outlier를 무시한 더 신뢰도 높은 모델**을 얻을 수 있습니다.
    

---

## 🧪 예제 (OpenCV + Python)

```python
import numpy as np
import cv2

# 임의의 noisy data 생성
X = np.linspace(0, 100, 100)
Y = 0.5 * X + 5 + np.random.normal(0, 5, X.shape)
# 이상치 추가
X[::10] += np.random.normal(0, 20, X[::10].shape)
Y[::10] += np.random.normal(0, 20, Y[::10].shape)

# 데이터를 (N,1,2) 형태로 재구성
points = np.column_stack((X, Y)).astype(np.float32)

# RANSAC을 통한 직선 피팅
line = cv2.fitLine(points, cv2.DIST_L2, 0, 0.99, 0.01)

vx, vy, x0, y0 = line.flatten()
slope = vy / vx
intercept = y0 - slope * x0

print(f"RANSAC 추정 직선: y = {slope:.2f}x + {intercept:.2f}")
```

---

## ✅ 장점 vs ❌ 단점

|장점|단점|
|---|---|
|이상치(outlier)에 매우 강함|반복 횟수와 허용 오차에 따라 결과가 달라짐|
|단순하고 범용적임|계산 비용이 큼 (반복적으로 모델 생성해야 함)|
|다양한 모델(선, 원, 호모그래피 등)에 적용 가능|모델 파라미터 수가 많아질수록 복잡도 증가|

---

## 📚 응용 분야

- **직선/곡선 검출** (ex: 도로 차선 검출)
    
- **Homography 추정** (ex: 영상 정합)
    
- **3D point cloud 정렬** (ex: LIDAR 매칭)
    
- **Fundamental matrix 추정** (ex: 스테레오 카메라)
    
- **물체 추적** (ex: optical flow와 함께)
    

---

## 🎓 연구 및 실무 팁

- 반복 횟수 kk는 다음 확률 식으로 결정 가능:
    
$$
k = \frac{\log(1 - p)}{\log(1 - w^n)}
$$
- $p$: 성공 확률 (예: 0.99)
    
- $w$: inlier의 비율
    
- $n$: 필요한 최소 샘플 수 (예: 직선이면 2개)
    
- Scikit-learn에서도 `RANSACRegressor`로 쉽게 사용 가능.
    

---

## 🧾 요약

|항목|설명|
|---|---|
|목적|이상치에 강건한 모델 추정|
|핵심|랜덤 샘플 + 일치성 평가 반복|
|적용 예|직선/곡선 피팅, 호모그래피 추정 등|
|강점|outlier 무시 가능|
|단점|반복 필요, 계산 비용 높음|

---

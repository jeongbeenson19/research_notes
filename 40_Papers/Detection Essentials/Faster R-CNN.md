### **초록(Abstract)**

최신 객체 탐지 네트워크들은 후보 영역(region proposal) 알고리즘에 의존하여 객체의 위치를 추정한다. [[SPPNet]]이나 [[Fast R-CNN]]과 같은 최신 연구들은 이러한 파이프라인의 계산 시간을 크게 단축시켰지만, 여전히 후보 영역 계산이 CPU에서 실행되어 병목 현상을 유발한다. 본 논문에서는 **후보 영역 네트워크(Region Proposal Network, RPN)** 를 도입하여, 전체 객체 탐지 네트워크가 컨볼루션 특징을 공유하면서 거의 비용 없이 후보 영역을 생성할 수 있도록 한다. RPN은 완전 컨볼루션 네트워크(fully convolutional network)로서, 각 위치에서 객체 경계와 객체 여부 점수(objectness score)를 동시에 예측한다. RPN은 end-to-end로 학습되어 고품질의 후보 영역을 생성하며, 이는 [[Fast R-CNN]]이 탐지에 사용한다. RPN과 [[Fast R-CNN]]을 하나의 네트워크로 통합함으로써, 우리는 컨볼루션 특징을 공유하는 단일 네트워크를 구성한다. 이 시스템은 VGG-16 모델을 사용하여 GPU 상에서 5fps의 프레임 속도를 달성하며, PASCAL VOC 2007, 2012 및 MS COCO 데이터셋에서 최첨단 객체 탐지 정확도를 달성한다.

---

### **1. 서론(Introduction)**

객체 탐지 분야는 [[Rich feature hierarchies for accurate object detection and semantic segmentation|R-CNN]]의 성공 이후, 후보 영역과 컨볼루션 신경망을 결합하는 패러다임이 주류를 이루었다. [[R-CNN]]은 속도가 느렸지만, [[Fast R-CNN]]은 컨볼루션 특징을 공유함으로써 속도를 크게 개선했다. 그러나 [[Fast R-CNN]]에서도 후보 영역 생성은 Selective Search와 같은 외부 알고리즘에 의존하여 CPU에서 수행되었고, 이는 전체 탐지 과정에서 심각한 속도 병목으로 작용했다.

본 논문은 이 병목 현상을 해결하기 위해, **딥러닝 네트워크가 스스로 후보 영역을 생성**하도록 하는 새로운 접근법을 제안한다. 우리는 [[Fast R-CNN]]의 컨볼루션 계층 위에 **후보 영역 네트워크(Region Proposal Network, RPN)** 라는 새로운 구성 요소를 추가한다. RPN은 입력으로 컨볼루션 특징 맵을 받아, 출력으로 직사각형 형태의 후보 영역들과 각 영역의 객체 점수(objectness score)를 생성한다. 이 구조는 "attention" 메커니즘과 유사하게, 네트워크의 내부 계산을 통해 탐색할 영역을 스스로 결정한다.

RPN을 사용함으로써, 후보 영역 생성과 객체 탐지가 동일한 컨볼루션 특징을 공유하게 되어 계산 효율성이 극대화된다. 그 결과, 전체 시스템은 거의 실시간에 가까운 속도로 동작할 수 있게 된다.

---

### **2. 후보 영역 네트워크 (Region Proposal Network, RPN)**

RPN의 목표는 이미지(또는 컨볼루션 특징 맵)를 입력받아 다양한 크기와 비율의 객체 후보 영역을 출력하는 것이다.

#### **2.1. 앵커 박스 (Anchor Boxes)**

RPN은 슬라이딩 윈도우 방식으로 컨볼루션 특징 맵을 탐색한다. 각 슬라이딩 윈도우의 중심 위치에서, 사전에 정의된 여러 개의 **앵커 박스(anchor box)** 를 기준으로 후보 영역을 예측한다.

-   **앵커 박스**: 특징 맵의 한 점(anchor)을 중심으로 하는 다양한 크기(scale)와 종횡비(aspect ratio)를 가진 참조용 박스들이다. 예를 들어, 3가지 크기와 3가지 종횡비(1:1, 1:2, 2:1)를 조합하여 총 9개의 앵커 박스를 각 위치마다 사용한다.
-   이 앵커 박스 방식은 다양한 형태의 객체를 효율적으로 처리할 수 있게 하며, 이미지 피라미드나 필터 피라미드를 사용하는 것보다 계산적으로 효율적이다.

#### **2.2. RPN 아키텍처**

RPN은 마지막 컨볼루션 특징 맵 위에 작은 네트워크를 슬라이딩시키는 형태로 구현된다.

1.  **입력**: ZFNet이나 VGGNet 같은 기본 네트워크의 마지막 컨볼루션 특징 맵.
2.  **중간 계층**: n x n 크기의 컨볼루션 필터(예: 3x3)를 거쳐 저차원 벡터(예: 256-d)로 변환된다.
3.  **출력**: 이 벡터는 두 개의 형제(sibling) 완전 연결 계층으로 전달된다.
    -   **분류 계층 (cls layer)**: 각 앵커 박스가 객체인지 배경인지를 판별하는 확률을 출력한다 (앵커당 2개의 점수).
    -   **회귀 계층 (reg layer)**: 각 앵커 박스의 위치를 더 정밀하게 조정하기 위한 좌표 오프셋(dx, dy, dw, dh)을 출력한다 (앵커당 4개의 값).

이러한 구조 덕분에 RPN은 컨볼루션 연산을 전체 특징 맵에 대해 공유하며 매우 빠르게 후보 영역을 생성할 수 있다.

---

### **3. 학습 (Training)**

Faster R-CNN은 RPN과 [[Fast R-CNN]] 탐지 네트워크를 통합하여 end-to-end로 학습될 수 있다.

#### **3.1. 손실 함수 (Loss Function)**

RPN은 각 앵커에 대해 이진 분류(객체 vs. 배경) 손실과 바운딩 박스 회귀 손실을 동시에 최적화하는 멀티태스크 손실 함수를 사용한다.

-   $L({p_i}, {t_i}) = \frac{1}{N_{cls}} \sum_i L_{cls}(p_i, p_i^*) + \lambda \frac{1}{N_{reg}} \sum_i p_i^* L_{reg}(t_i, t_i^*)$
-   $p_i$: 앵커 $i$가 객체일 예측 확률.
-   $p_i^*$: 실제 레이블 (객체이면 1, 배경이면 0).
-   $t_i$: 예측된 바운딩 박스 회귀값.
-   $t_i^*$: 실제 바운딩 박스 회귀 목표값.
-   $L_{cls}$: 로그 손실 (분류).
-   $L_{reg}$: Smooth L1 손실 (회귀).

#### **3.2. 4단계 교대 학습 (4-Step Alternating Training)**

RPN과 [[Fast R-CNN]]이 컨볼루션 계층을 공유하면서도 각자의 가중치를 학습해야 하므로, 다음과 같은 4단계 교대 학습 방식을 사용한다.

1.  **1단계 (RPN 학습)**: ImageNet으로 사전 학습된 모델을 가져와 RPN을 end-to-end로 학습시킨다.
2.  **2단계 (Fast R-CNN 학습)**: 1단계에서 생성된 후보 영역을 사용하여, ImageNet 사전 학습 모델로 초기화된 별도의 [[Fast R-CNN]] 탐지 네트워크를 학습시킨다. 이 단계에서는 컨볼루션 계층 가중치가 업데이트된다.
3.  **3단계 (RPN 미세 조정)**: 2단계에서 학습된 공유 컨볼루션 가중치를 고정한 채, RPN의 고유 계층들만 미세 조정한다.
4.  **4단계 (Fast R-CNN 미세 조정)**: 공유 컨볼루션 가중치와 RPN을 고정한 채, [[Fast R-CNN]]의 완전 연결 계층을 미세 조정한다.

이 과정을 통해 두 네트워크는 동일한 컨볼루션 계층을 공유하며 협력적으로 학습된다.

---

### **4. 실험 및 결과**

-   **속도**: VGG-16 기반의 Faster R-CNN은 PASCAL VOC 데이터셋에서 5fps(이미지당 200ms)의 속도를 기록했다. 이는 후보 영역 생성(약 10ms)과 객체 탐지를 모두 포함한 시간으로, Selective Search(이미지당 약 2초)를 사용하던 [[Fast R-CNN]]에 비해 비약적인 발전이다.
-   **정확도**: Faster R-CNN은 PASCAL VOC 2007, 2012 데이터셋에서 기존의 최첨단 방법들( [[Fast R-CNN]] 포함)보다 높은 mAP를 달성했다. 이는 RPN이 생성하는 후보 영역의 품질이 높고, 공유된 특징이 탐지 정확도 향상에 기여함을 의미한다.
-   **앵커 박스의 효과**: 다양한 크기와 종횡비의 앵커 박스를 사용하는 것이 단일 크기/비율의 앵커를 사용하는 것보다 성능이 우수함을 실험적으로 증명했다.

---

### **5. 결론**

본 논문은 딥러닝 기반 객체 탐지기의 속도 병목이었던 후보 영역 생성을 네트워크 내부로 통합한 **Faster R-CNN**을 제안했다. **RPN**은 거의 추가 비용 없이 컨볼루션 특징을 공유하여 정확하고 빠른 후보 영역 생성을 가능하게 했다. 이를 통해 객체 탐지 시스템은 최초로 단일 통합 네트워크(unified network)로 구성되어 end-to-end 학습이 가능해졌으며, 실시간에 가까운 성능을 달성했다. 이 연구는 이후 YOLO, SSD 등 다양한 실시간 객체 탐지 모델의 발전에 큰 영향을 미쳤다.
